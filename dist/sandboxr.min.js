!function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{var t;t="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,t.SandBoxr=e()}}(function(){return function e(t,r,n){function i(a,u){if(!r[a]){if(!t[a]){var s="function"==typeof require&&require;if(!u&&s)return s(a,!0);if(o)return o(a,!0);var c=new Error("Cannot find module '"+a+"'");throw c.code="MODULE_NOT_FOUND",c}var l=r[a]={exports:{}};t[a][0].call(l.exports,function(e){var r=t[a][1][e];return i(r?r:e)},l,l.exports,e,t,r,n)}return r[a].exports}for(var o="function"==typeof require&&require,a=0;a<n.length;a++)i(n[a]);return i}({1:[function(e,t,r){"use strict";function n(e,t){this.ast=e,this.config=t||{},this.env=null}var i=e("./handlers"),o=e("./env"),a=e("./execution-context");n.prototype.execute=function(e){if(this.env||(this.createEnvironment(),this.env.init(this.config)),e||(e=new a(this.env,this.ast)),!(e.node.type in i))throw new TypeError("No handler defined for: "+e.node.type);return i[e.node.type](e)},n.prototype.createEnvironment=function(){return this.env=new o(this)},t.exports=n},{"./env":16,"./execution-context":20,"./handlers":37}],2:[function(e,t,r){"use strict";function n(e,t){return 0>e?Math.max(t-Math.abs(e),0):Math.min(e||0,t)}function i(e,t){return 0>e?Math.max(t+e,0):Math.min(e,t)}function o(e,t){return t.hasProperty("length")?p.toUInt32(e,t.getProperty("length").getValue()):0}function a(e,t,r,n){var i=p.toObject(r.env,r.node),o=r.env.createScope(t||r.env.global);o.init(e.node.body);var a,u=r.env.global.getProperty("undefined").getValue(),s=r.env.objectFactory,c=[r.node.getProperty(n).getValue(),s.createPrimitive(n),i];l.loadArguments(r.env,e.node.params,c);try{return a=r.create(e.node.body,e.node).execute(),a?a.result:u}catch(f){throw o.exitScope(),f}o.exitScope()}function u(e,t,r,n){var i=p.toObject(r.env,r.node),o=r.env.createScope();o.init(e.node.body);var a,u=r.env.global.getProperty("undefined").getValue(),s=r.env.objectFactory,c=[t||u,r.node.getProperty(n).getValue()||u,s.createPrimitive(n),i];l.loadArguments(r.env,e.node.params,c);try{return a=r.create(e.node.body,e.node).execute(),a?a.result:u}catch(f){throw o.exitScope(),f}o.exitScope()}function s(e){return{value:e,configurable:!0,enumerable:!0,writable:!0}}var c=e("../utils/contracts"),l=e("../utils/func"),p=e("../utils/convert"),f=e("../types/array-type");t.exports=function(e){function t(t){var r=o(e,this.node);t=0===arguments.length||t===h?",":p.toPrimitive(e,t,"string");for(var n,i=[],a=0;r>a;a++)n="",this.node.hasProperty(a)&&(n=this.node.getProperty(a).getValue(),n=c.isNullOrUndefined(n)?"":p.toString(e,n)),i.push(n);return v.createPrimitive(i.join(t))}var r=e.global,v=e.objectFactory,h=r.getProperty("undefined").getValue(),d=v.createFunction(function(t){var r=v.create("Array");if(arguments.length>0)if(1===arguments.length&&"number"===t.type)c.assertIsValidArrayLength(arguments[0].value),r.putValue("length",t,!1,this);else for(var n=0,i=arguments.length;i>n;n++)r.defineOwnProperty(n,s(arguments[n]),!1,e);return r},null,{configurable:!1,enumerable:!1,writable:!1}),y=d.getProperty("prototype").getValue();y.className="Array",y.define("length",v.createPrimitive(0),{configurable:!1,enumerable:!1,writable:!0}),d.define("isArray",v.createBuiltInFunction(function(e){return v.createPrimitive(!(!e||"Array"!==e.className))},1,"Array.isArray")),y.define("push",v.createBuiltInFunction(function(t){for(var r=o(e,this.node),n=0,i=arguments.length;i>n;n++)this.node.defineOwnProperty(r+n,s(arguments[n]),!0,e);var a=v.createPrimitive(r+n);return this.node.putValue("length",a,!0),a},1,"Array.prototype.push")),y.define("pop",v.createBuiltInFunction(function(){var t,r=o(e,this.node);return r>0&&(r--,this.node.hasProperty(r)&&(t=this.node.getProperty(r).getValue(),this.node.deleteProperty(r,!0))),this.node.putValue("length",v.createPrimitive(r)),t||h},0,"Array.prototype.pop")),y.define("shift",v.createBuiltInFunction(function(){var t,r=o(e,this.node),n=0;if(r>0){for(this.node.hasProperty(n)&&(t=this.node.getProperty(n).getValue(),this.node.deleteProperty(n));++n<r;)this.node.hasProperty(n)?this.node.putValue(n-1,this.node.getProperty(n).getValue()):this.node.deleteProperty(n);this.node.deleteProperty(r-1)}return this.node.putValue("length",v.createPrimitive(0===r?0:--r)),t||h},0,"Array.prototype.shift")),y.define("unshift",v.createBuiltInFunction(function(){for(var t,r,n=o(e,this.node),i=arguments.length,a=n;a>0;)r=a-1,t=a+i-1,this.node.hasProperty(r)?this.node.putValue(t,this.node.getProperty(r).getValue(),!0):this.node.deleteProperty(t,!0),a--;for(a=0;i>a;a++)this.node.putValue(a,arguments[a],!0);var u=v.createPrimitive(i+n);return this.node.putValue("length",u,!0),u},1,"Array.prototype.unshift")),y.define("slice",v.createBuiltInFunction(function(t,r){var a=this.node,u=o(e,this.node);t=t?p.toInteger(e,t):0,r=r&&"undefined"!==r.type?p.toInteger(e,r):u;var c=v.create("Array"),l=0;t=n(t,u),r=i(r,u);for(var f=t;r>f;f++)c.defineOwnProperty(l++,s(a.getProperty(f).getValue()),!0,e);return c},2,"Array.prototype.slice")),y.define("splice",v.createBuiltInFunction(function(t,r){var n=o(e,this.node);t=p.toInteger(e,t),t=0>t?Math.max(n+t,0):Math.min(t,n),r=p.toInteger(e,r),r=0>r?0:Math.min(Math.max(r,0),n-t);for(var i=v.create("Array"),a=0;r>a;)this.node.hasProperty(a+t)&&i.defineOwnProperty(a,s(this.node.getProperty(a+t).getValue()),!0,e),a++;var u=arguments.length-2;if(r>u){for(a=t;n-r>a;)this.node.hasProperty(a+r)?this.node.putValue(a+u,this.node.getProperty(a+r).getValue()):this.node.deleteProperty(a+r),a++;for(a=n;a>n-r+u;)this.node.deleteProperty(--a)}else if(u>r)for(a=n-t;a>t;)this.node.hasProperty(a+r-1)?this.node.putValue(a+u-1,this.node.getProperty(a+r-1).getValue()):this.node.deleteProperty(a+u-1),a--;a=t;for(var c=0;u>c;c++)this.node.putValue(a,arguments[c+2]),a++;return this.node.putValue("length",v.createPrimitive(n-r+u)),i},2,"Array.prototype.splice")),y.define("concat",v.createBuiltInFunction(function(){var t=v.create("Array"),r=Array.prototype.slice.call(arguments);r.unshift(p.toObject(e,this.node));for(var n,i,o,a=0;r.length>0;)if(n=r.shift(),n instanceof f)for(i=0,o=n.getProperty("length").getValue().value;o>i;i++)n.hasProperty(i)&&t.defineOwnProperty(a,s(n.getProperty(i).getValue()),!0,e),a++;else t.defineOwnProperty(a++,s(n),!0,e);return t.putValue("length",v.createPrimitive(a),!0),t},1,"Array.prototype.concat")),y.define("join",v.createBuiltInFunction(t,1,"Array.prototype.join")),y.define("indexOf",v.createBuiltInFunction(function(t,r){t=t||h;var i=o(e,this.node),a=1===arguments.length?0:p.toInteger(e,r),u=v.createPrimitive(-1);if(0===i||a>=i)return u;for(a=n(a,i);i>a;a++)if(this.node.hasProperty(a)&&t.equals(this.node.getProperty(a).getValue()||h))return v.createPrimitive(a);return u},1,"Array.prototype.indexOf")),y.define("lastIndexOf",v.createBuiltInFunction(function(t,r){t=t||h;var n=o(e,this.node),i=1===arguments.length?n-1:p.toInteger(e,r);for(0>i&&(i=n-Math.abs(i));i>=0;i--)if(this.node.hasProperty(i)&&t.equals(this.node.getProperty(i).getValue()||h))return v.createPrimitive(i);return v.createPrimitive(-1)},1,"Array.prototype.lastIndexOf")),y.define("forEach",v.createBuiltInFunction(function(t,r){var n=o(e,this.node);c.assertIsFunction(t,this.node);for(var i=0;n>i;i++)this.node.hasProperty(i)&&a(t,r,this,i)},1,"Array.prototype.forEach")),y.define("map",v.createBuiltInFunction(function(t,r){var n=o(e,this.node);c.assertIsNotNullOrUndefined(this.node,"Array.prototype.map"),c.assertIsFunction(t,this.node);var i=v.create("Array");i.putValue("length",v.createPrimitive(n));for(var u=0;n>u;u++)this.node.hasProperty(u)&&i.defineOwnProperty(u,s(a(t,r,this,u)),!0,e);return i},1,"Array.prototype.map")),y.define("filter",v.createBuiltInFunction(function(t,r){c.assertIsNotNullOrUndefined(this.node,"Array.prototype.filter");var n=o(e,this.node);c.assertIsFunction(t,this.node);for(var i=v.create("Array"),u=0,l=0;n>l;l++)p.toBoolean(this.node.hasProperty(l)&&a(t,r,this,l))&&i.defineOwnProperty(u++,s(this.node.getProperty(l).getValue()),!0,e);return i},1,"Array.prototype.filter")),y.define("every",v.createBuiltInFunction(function(t,r){c.assertIsNotNullOrUndefined(this.node,"Array.prototype.every");var n=o(e,this.node);c.assertIsFunction(t,this.node);for(var i=0;n>i;i++)if(this.node.hasProperty(i)&&!p.toBoolean(a(t,r,this,i)))return v.createPrimitive(!1);return v.createPrimitive(!0)},1,"Array.prototype.every")),y.define("some",v.createBuiltInFunction(function(t,r){c.assertIsNotNullOrUndefined(this.node,"Array.prototype.some");var n=o(e,this.node);c.assertIsFunction(t,this.node);for(var i=0;n>i;i++)if(p.toBoolean(this.node.hasProperty(i)&&a(t,r,this,i)))return v.createPrimitive(!0);return v.createPrimitive(!1)},1,"Array.prototype.some")),y.define("reduce",v.createBuiltInFunction(function(t,r){var n=o(e,this.node);c.assertIsNotNullOrUndefined(this.node,"Array.prototype.reduce"),c.assertIsFunction(t,this.node);var i,a=0;if(arguments.length>=2)i=r;else{for(;n>a&&!this.node.hasProperty(a);)a++;if(a>=n)throw new TypeError("Reduce of empty array with no initial value");i=this.node.getProperty(a++).getValue()}for(;n>a;a++)this.node.hasProperty(a)&&(i=u(t,i,this,a));return i},1,"Array.prototype.reduce")),y.define("reduceRight",v.createBuiltInFunction(function(t,r){var n=o(e,this.node);c.assertIsNotNullOrUndefined(this.node,"Array.prototype.reduceRight"),c.assertIsFunction(t,this.node);var i;if(0===n&&1===arguments.length)throw new TypeError("Reduce of empty array with no initial value");var a=n-1;if(arguments.length>=2)i=r;else{for(var s=!1;a>=0&&!s;)s=this.node.hasProperty(a),s&&(i=this.node.getProperty(a).getValue()),a--;if(!s)throw new TypeError("Reduce of empty array with no initial value")}for(;a>=0;)this.node.hasProperty(a)&&(i=u(t,i,this,a)),a--;return i},1,"Array.prototype.reduceRight")),y.define("reverse",v.createBuiltInFunction(function(){for(var t,r,n,i=o(e,this.node),a=Math.floor(i/2),u=0;u!==a;)t=i-u-1,n=this.node.hasProperty(u)&&this.node.getProperty(u).getValue(),r=this.node.hasProperty(t)&&this.node.getProperty(t).getValue(),r&&this.node.putValue(u,r,!0),n&&this.node.putValue(t,n,!0),r&&!n?this.node.deleteProperty(t):n&&!r&&this.node.deleteProperty(u),u++;return this.node},0,"Array.prototype.reverse")),y.define("sort",v.createBuiltInFunction(function(t){var r,n=this,i=this.node,a=o(e,i),u=0;r=c.isNullOrUndefined(t)?function(t,r){return t=p.toString(e,t),r=p.toString(e,r),r>t?-1:t>r?1:0}:function(r,i){var o=e.createScope(h);o.init(t.node.body),l.loadArguments(e,t.node.params,[r,i]);var a;try{a=n.create(t.node.body,t.node).execute()}catch(u){throw o.exitScope(),u}return o.exitScope(),a&&a.exit&&a.result?a.result.getValue().value:void 0};for(var s=p.toArray(i,a).map(function(e){return e.isPrimitive&&void 0===e.value?void 0:e}).sort(r);a>u;)u in s?i.putValue(u,s[u],!1,e):i.deleteProperty(u,!1),u++;return i},1,"Array.prototype.sort")),y.define("toLocaleString",v.createBuiltInFunction(function(){for(var t,r=o(e,this.node),n=new Array(r),i=0;r>i;)this.node.hasProperty(i)&&(t=this.node.getProperty(i).getValue(),n[i]=c.isNullOrUndefined(t)?"":p.toString(e,l.tryCallMethod(e,t,"toLocaleString"))),i++;return v.createPrimitive(n.join())},0,"Array.prototype.toLocaleString")),y.define("toString",v.createBuiltInFunction(t,0,"Array.prototype.toString")),r.define("Array",d)}},{"../types/array-type":57,"../utils/contracts":68,"../utils/convert":69,"../utils/func":70}],3:[function(e,t,r){"use strict";var n=e("../utils/convert");t.exports=function(e){var t=e.global,r=e.objectFactory,i=r.createFunction(function(t){var i=n.toBoolean(t);return this.isNew?n.primitiveToObject(e,i):r.create("Boolean",i)},null,{configurable:!1,enumerable:!1,writable:!1}),o=i.getProperty("prototype").getValue();o.className="Boolean",o.value=!1,o.define("toString",r.createBuiltInFunction(function(){if("Boolean"!==this.node.className)throw new TypeError("Boolean.prototype.toString is not generic.");return r.createPrimitive(String(this.node.value))},0,"Boolean.prototype.toString")),o.define("valueOf",r.createBuiltInFunction(function(){if("Boolean"!==this.node.className)throw new TypeError("Boolean.prototype.valueOf is not generic.");return r.createPrimitive(this.node.value)},0,"Boolean.prototype.valueOf")),t.define("Boolean",i)}},{"../utils/convert":69}],4:[function(e,t,r){"use strict";var n=e("../utils/convert"),i=["log","info","error"];t.exports=function(e){var t=e.global,r=e.objectFactory,o=r.createObject();i.forEach(function(t){o.define(t,r.createBuiltInFunction(function(r){var i=n.toString(e,r);console[t](i)},1,"console."+t))}),t.define("console",o)}},{"../utils/convert":69}],5:[function(e,t,r){"use strict";var n=e("../utils/convert"),i=["now"],o=["getDate","getDay","getFullYear","getHours","getMilliseconds","getMinutes","getMonth","getMilliseconds","getMinutes","getMonth","getSeconds","getTime","getTimezoneOffset","getUTCDay","getUTCDate","getUTCFullYear","getUTCHours","getUTCMilliseconds","getUTCMinutes","getUTCMonth","getUTCSeconds","getYear","toDateString","toGMTString","toISOString","toJSON","toLocaleString","toLocaleDateString","toLocaleTimeString","toString","toTimeString","toUTCString"],a=["setDate","setFullYear","setHours","setMilliseconds","setMinutes","setMonth","setSeconds","setTime","setUTCDate","setUTCFullYear","setUTCHours","setUTCMilliseconds","setUTCMinutes","setUTCMonth","setUTCSeconds","setYear"],u=Array.prototype.slice;t.exports=function(e){var t=e.global,r=e.objectFactory,s=r.createFunction(function(t,i,o,a,s,c,l){var p,f;if(0===arguments.length)f=[];else if(1===arguments.length)if(t.isPrimitive)f=[t.value];else{var v=n.toPrimitive(e,t);"string"!=typeof v&&(v=n.toNumber(e,t)),f=[v]}else f=u.call(arguments).map(function(t){return n.toPrimitive(e,t,"number")});if(this.isNew){switch(f.length){case 0:p=new Date;break;case 1:p=new Date(f[0]);break;default:for(var h=f.length;7>h;)f[h++]=3===h?1:0;p=new Date(f[0],f[1],f[2],f[3],f[4],f[5],f[6])}return r.create("Date",p)}return p=Date.apply(null,f),r.createPrimitive(p)},null,{configurable:!1,enumerable:!1,writable:!1});s.define("parse",r.createBuiltInFunction(function(t){var i=n.toPrimitive(e,t,"string"),o=Date.parse(i);return r.createPrimitive(o)},1,"Date.prototype.parse")),s.define("UTC",r.createBuiltInFunction(function(t,i,o,a,s,c,l){var p=u.call(arguments).map(function(t){return n.toPrimitive(e,t,"number")});return r.createPrimitive(Date.UTC.apply(null,p))},7,"Date.prototype.UTC"));var c=s.getProperty("prototype").getValue();c.className="Date",c.value=new Date(Date.prototype),i.forEach(function(t){s.define(t,n.toNativeFunction(e,Date[t],"Date."+t))}),o.forEach(function(t){c.define(t,n.toNativeFunction(e,Date.prototype[t],"Date.prototype."+t))}),a.forEach(function(t){function i(){var r=u.call(arguments).map(function(t){return n.toPrimitive(e,t)});Date.prototype[t].apply(this.node.value,r)}c.define(t,r.createBuiltInFunction(i,Date.prototype[t].length,"Date.prototype."+t))}),c.define("valueOf",r.createBuiltInFunction(function(){return r.createPrimitive(this.node.value.valueOf())},0,"Date.prototype.valueOf")),t.define("Date",s)}},{"../utils/convert":69}],6:[function(e,t,r){"use strict";function n(e,t,r){var n=null;r&&(n={name:r});var i=e.create("Error",n);return o.isNullOrUndefined(t)||i.defineOwnProperty("message",{value:t,configurable:!0,enumerable:!1,writable:!0},!1),i}var i=e("../utils/convert"),o=e("../utils/contracts"),a=["TypeError","ReferenceError","SyntaxError","RangeError","URIError","EvalError"];t.exports=function(e){var t=e.global,r=e.objectFactory,o=r.createFunction(function(e){return n(r,e)},null,{configurable:!1,enumerable:!1,writable:!1}),u=o.getProperty("prototype").getValue();u.className="Error",u.define("name",r.createPrimitive("Error")),u.define("message",r.createPrimitive("")),u.define("toString",r.createBuiltInFunction(function(){var t,n=this.node.getProperty("name").getValue();return this.node.hasProperty("message")&&(t=i.toString(e,this.node.getProperty("message").getValue())),n=n&&i.toString(e,n),n&&t?r.create("String",n+": "+t):r.create("String",n||t)},0,"Error.prototype.toString")),t.define("Error",o),a.forEach(function(e){var i=r.createFunction(function(t){return n(r,t,e)},null,{configurable:!1,enumerable:!1,writable:!1}),o=i.getProperty("prototype").getValue();o.define("name",r.createPrimitive(e)),o.setPrototype(u),t.define(e,i)})}},{"../utils/contracts":68,"../utils/convert":69}],7:[function(e,t,r){"use strict";function n(e,t,r){return t.builtIn?r||e.global.getProperty("undefined").getValue():o.isNullOrUndefined(r)?e.global:i.toObject(e,r)}var i=e("../utils/convert"),o=e("../utils/contracts"),a=e("../utils/func"),u=e("../types/native-function-type"),s=Array.prototype.slice,c={configurable:!1,enumerable:!1,writable:!1};t.exports=function(e,t){var r,l=e.global,p=e.global.getProperty("undefined").getValue(),f=e.objectFactory,v=function(){var n;if(t.parser&&arguments.length>0){var u=s.call(arguments),c=u.pop();u.length>0&&(u=u.map(function(t,r){if(o.isNull(t))throw new SyntaxError("Unexpected token null");return o.isUndefined(t)?"":i.toString(e,t)}).join(",").split(/\s*,\s*/g));var v=t.parser("(function(){"+i.toString(e,c)+"}).apply(this,arguments);"),h=u.map(function(e){return e=e.trim(),o.assertIsValidParameterName(e),{type:"Identifier",name:e}}),d={type:"FunctionDeclaration",params:h,body:v},y=f.createFunction(d),g=function(){var e=this.node||l;this.isNew&&(e=f.createObject(n));var t=a.getFunctionResult(this,y,h,arguments,e,d);return this.isNew?e:t&&t.result||p};g.nativeLength=d.params.length,n=f.createFunction(g),n.bindScope(e.globalScope)}else n=f.createFunction(function(){});return n.putValue("constructor",r),n},h=new u(function(){});v.nativeLength=1,r=f.createFunction(v,h,c),r.putValue("constructor",r),l.define("Function",r),h.define("length",f.createPrimitive(0),c),r.setPrototype(h),h.define("toString",f.createBuiltInFunction(function(){return f.createPrimitive(this.node["native"]?"function () { [native code] }":"function () { [user code] }")},0,"Function.prototype.toString")),h.define("call",f.createBuiltInFunction(function(t){var r=s.call(arguments,1),i=this.node["native"]?[]:this.node.node.params,o=this.node["native"]?this.node:this.node.node;return t=n(e,this.node,t),this.node.bindThis(t),a.executeFunction(this,this.node,i,r,t,o)},1,"Function.prototype.call")),h.define("apply",f.createBuiltInFunction(function(t,r){if(r&&"Arguments"!==r.className&&"Array"!==r.className)throw new TypeError("Arguments list was wrong type");var o=i.toArray(r),u=this.node["native"]?[]:this.node.node.params,s=this.node["native"]?this.node:this.node.node;return t=n(e,this.node,t),this.node.bindThis(t),a.executeFunction(this,this.node,u,o,t,s)},2,"Function.prototype.apply")),h.define("bind",f.createBuiltInFunction(function(t){var r=s.call(arguments,1),i=this.node,o=i["native"]?[]:i.node.params,u=i["native"]?i:i.node;t=n(e,this.node,t);var c=function(){throw new TypeError("'caller', 'callee', and 'arguments' properties may not be accessed on strict mode functions or the arguments objects for calls to them")},l={get:void 0,getter:c,set:void 0,setter:c,enumerable:!1,configurable:!1},p=function(){var e=r.concat(s.call(arguments));return a.executeFunction(this,i,o,e,t,u,this.isNew)};p.nativeLength=Math.max(o.length-r.length,0);var v=f.createFunction(p);return v.defineOwnProperty("caller",l),v.defineOwnProperty("arguments",l),v.defineOwnProperty("callee",l),v.bindScope(this.env.current),v.bindThis(t),v},1,"Function.prototype.bind"))}},{"../types/native-function-type":61,"../utils/contracts":68,"../utils/convert":69,"../utils/func":70}],8:[function(e,t,r){(function(r){"use strict";var n=e("../types/primitive-type"),i=e("../types/object-factory"),o=e("./number-api"),a=e("./string-api"),u=e("./function-api"),s=e("./object-api"),c=e("./boolean-api"),l=e("./date-api"),p=e("./array-api"),f=e("./math-api"),v=e("./regex-api"),h=e("./error-api"),d=e("./json-api"),y=e("./console-api"),g=e("../utils/convert"),m=e("../env/reference"),b={configurable:!1,enumerable:!1,writable:!1};t.exports=function(e,t){var P=e.objectFactory=new i(e),w=e.global=P.createObject();e.createObjectScope(w);var x=new n(void 0);w.define("undefined",x,b);var O=new n(null);if(w.define("null",O,b),w.define("Infinity",P.createPrimitive(1/0),b),w.define("NaN",P.createPrimitive(0/0),b),w.define("window",w,b),u(e,t),s(e,t),p(e,t),c(e,t),o(e,t),a(e,t),l(e,t),v(e,t),f(e,t),h(e,t),d(e,t),y(e,t),["parseFloat","decodeURI","encodeURI","decodeURIComponent","encodeURIComponent","escape","unescape"].forEach(function(t){w.define(t,P.createBuiltInFunction(function(n){var i=g.toString(e,n);return P.createPrimitive(r[t](i))},1,t))}),["isNaN","isFinite"].forEach(function(t){w.define(t,g.toNativeFunction(e,r[t],t))}),w.define("parseInt",P.createBuiltInFunction(function(t,r){var n=g.toString(e,t);return r=g.toPrimitive(e,r,"number"),P.createPrimitive(parseInt(n,r))},2,"parseInt")),t.parser){var V=P.createBuiltInFunction(function(r){if(!r)return x;if("string"!==r.type)return r;var n,i=!(this.callee instanceof m)||this.callee.base!==w;try{n=t.parser(r.value)}catch(o){if(o instanceof SyntaxError&&/assigning to rvalue/i.test(o.message))throw new ReferenceError("Invalid left-hand side in assignment");throw o}var a,u=e.setScope(i?e.globalScope:e.current.parent);try{a=this.create(n).execute()}catch(o){throw u.exitScope(),o}return u.exitScope(),a&&a.result?a.result.getValue():x},1,"eval");w.define("eval",V)}P.init()}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../env/reference":19,"../types/object-factory":62,"../types/primitive-type":64,"../utils/convert":69,"./array-api":2,"./boolean-api":3,"./console-api":4,"./date-api":5,"./error-api":6,"./function-api":7,"./json-api":9,"./math-api":10,"./number-api":11,"./object-api":12,"./regex-api":13,"./string-api":14}],9:[function(e,t,r){"use strict";function n(e,t){return Array(t+1).join(e)}function i(e,t,r){if(0===e.length)return"";if(!t)return e.join(",");var i="\n"+n(t,r),o=e.join(i+",");return i+o+"\n"+n(t,r-1)}function o(e){return JSON.stringify(e)}function a(e,t,r,n,a,u){var c,l=a?": ":":",p=[];for(var f in r.properties)r.properties[f].enumerable&&(c=n(r,f,r.getProperty(f).getValue()),d.isNullOrUndefined(c)||p.push(o(f)+l+s(e,t,c,n,a,u)));return"{"+i(p,a,u,a,u)+"}"}function u(e,t,r,n,o,a){for(var u,c=r.getProperty("length").getValue().value,l=[],p=0;c>p;p++)u=void 0,r.hasProperty(p)&&(u=n(r,String(p),r.getProperty(p).getValue())),l.push(d.isNullOrUndefined(u)?"null":s(e,t,u,n));return"["+i(l,o,a)+"]"}function s(e,t,r,n,i,s){if(!r)return o();if(r.isPrimitive||r.className in y)return o(r.value);if("Function"===r.className)return void 0;var c=h.tryCallMethod(e,r,"toJSON");if(c)return o(c.value);if(t.indexOf(r)>=0)throw new TypeError("Converting circular structure to JSON");s++,t.push(r);var l;return l="Array"===r.className?u(e,t,r,n):a(e,t,r,n,i,s),s--,t.pop(),l}function c(e,t){if(t){if("Function"===t.className)return function(r,n,i){var o=[e.env.objectFactory.createPrimitive(n),i],a=t["native"]?[]:t.node.params,u=t["native"]?t:t.node;return h.executeFunction(e,t,a,o,r,u)};if("Array"===t.className){var r=v.toArray(t).map(function(t){return"String"===t.className?v.toString(e.env,t):"Number"===t.className?String(v.toNumber(e.env,t)):void 0});return function(e,t,n){return!t||r.indexOf(t)>=0?n:void 0}}}return function(e,t,r){return r}}function l(e,t){if(t){if("Number"===t.className){var r=Math.floor(v.toNumber(e,t));return r=Math.max(Math.min(10,r),0),r>0?n(" ",r):""}if("String"===t.className){var i=v.toString(e,t);return i.substr(0,10)}}return""}function p(e,t,r){var n=d.getType(t);switch(n){case"Undefined":case"Null":case"String":case"Number":case"Boolean":return e.create(n,t);case"Array":var i=e.create("Array");return t.forEach(function(t,n){var o=r(i,String(n),p(e,t,r));d.isUndefined(o)||i.defineOwnProperty(n,{value:p(e,t),configurable:!0,enumerable:!0,writable:!0})}),i;default:var o,a=e.createObject();for(var u in t)t.hasOwnProperty(u)&&(o=r(a,u,p(e,t[u],r)),d.isUndefined(o)||a.defineOwnProperty(u,{value:o,configurable:!0,enumerable:!0,writable:!0}));return a}}function f(e,t){return t&&"Function"===t.className?function(r,n,i){var o=[e.env.objectFactory.createPrimitive(n),i],a=t["native"]?[]:t.node.params,u=t["native"]?t:t.node;return h.executeFunction(e,t,a,o,r,u)}:function(e,t,r){return r}}var v=e("../utils/convert"),h=e("../utils/func"),d=e("../utils/contracts"),y={String:!0,Number:!0,Boolean:!0,Date:!0};t.exports=function(e){var t=e.global,r=e.objectFactory,n=e.global.getProperty("undefined").getValue(),i=r.createObject();i.className="JSON",i.define("stringify",r.createBuiltInFunction(function(t,i,o){if(i=c(this,i),o=l(e,o),t=i(t,"",t),d.isUndefined(t))return n;var a=[];return r.createPrimitive(s(e,a,t,i,o,0))},3,"JSON.stringify")),i.define("parse",r.createBuiltInFunction(function(t,i){i=f(this,i);var o=v.toString(e,t),a=JSON.parse(o),u=p(r,a,i);return i(u,"",u)||n},2,"JSON.parse")),t.define("JSON",i)}},{"../utils/contracts":68,"../utils/convert":69,"../utils/func":70}],10:[function(e,t,r){"use strict";var n=e("../utils/convert"),i=["E","LN10","LN2","LOG10E","LOG2E","PI","SQRT1_2","SQRT2"],o=["abs","acos","asin","atan","atan2","ceil","cos","exp","floor","log","max","min","pow","random","round","sin","sqrt","tan"];t.exports=function(e){var t=e.global,r=e.objectFactory,a=r.createObject();a.className="Math",i.forEach(function(e){a.define(e,r.createPrimitive(Math[e]),{configurable:!1,enumerable:!1,writable:!1})}),o.forEach(function(t){a.define(t,n.toNativeFunction(e,Math[t],"Math."+t))}),t.define("Math",a)}},{"../utils/convert":69}],11:[function(e,t,r){"use strict";var n=e("../utils/convert"),i=["MAX_VALUE","MIN_VALUE","NaN","NEGATIVE_INFINITY","POSITIVE_INFINITY"],o=["toExponential","toPrecision","toLocaleString"];t.exports=function(e){var t=e.global,r=e.objectFactory,a=r.createFunction(function(t){var i=Number(n.toPrimitive(e,t,"number"));return this.isNew?n.primitiveToObject(e,i):r.create("Number",i)},null,{configurable:!1,enumerable:!1,writable:!1}),u=a.getProperty("prototype").getValue();u.className="Number",u.value=0,u.define("toString",r.createBuiltInFunction(function(t){if("Number"!==this.node.className)throw new TypeError("Number.prototype.toString is not generic");var i=10;if(t&&(i=n.toPrimitive(e,t,"number"),2>i||i>36))throw new RangeError("toString() radix argument must be between 2 and 36");return r.createPrimitive(null==this.node.value?"0":this.node.value.toString(i))},1,"Number.prototype.toString")),u.define("toFixed",r.createBuiltInFunction(function(t){var i=0;return t&&(i=n.toNumber(e,t)),r.createPrimitive(Number.prototype.toFixed.call(this.node.value,i))},1,"Number.prototype.toFixed")),u.define("valueOf",r.createBuiltInFunction(function(){if("Number"!==this.node.className)throw new TypeError("Number.prototype.valueOf is not generic");return r.createPrimitive(null==this.node.value?0:this.node.value)},0,"Number.prototype.valueOf")),i.forEach(function(e){a.define(e,r.createPrimitive(Number[e]),{configurable:!1,enumerable:!1,writable:!1})}),o.forEach(function(t){var r=Number.prototype[t];r&&u.define(t,n.toNativeFunction(e,r,"Number.prototype."+t))}),t.define("Number",a)}},{"../utils/convert":69}],12:[function(e,t,r){"use strict";function n(e){return e?e.isPrimitive?e.value&&"object"===e.type:!0:!1}function i(e,t,r,i){if(!n(i))throw new TypeError("Property description must be an object: "+a.toString(e.env,i));var o=e.env.global.getProperty("undefined").getValue(),u={};if(i){var c=i.hasProperty("value"),l=i.hasProperty("get"),p=i.hasProperty("set");if((c||i.hasProperty("writable"))&&(l||p))throw new TypeError("Invalid property. A property cannot both have accessors and be writable or have a value");["writable","enumerable","configurable"].forEach(function(e){if(i.hasProperty(e)){var t=i.getProperty(e).getValue();u[e]=a.toBoolean(t)}});var f=e.env.current;if(l){var v=i.getProperty("get").getValue()||o;if(v.isPrimitive&&void 0===v.value)u.get=u.getter=void 0;else{if("Function"!==v.className)throw new TypeError("Getter must be a function: "+a.toString(e.env,v));u.get=v,u.getter=function(){var t=e.env.setScope(f),r=a.toObject(e.env,this);try{var n=s.getFunctionResult(e,v,v.node.params,[],r,v.node);return t.exitScope(),n&&n.exit?n.result.getValue():o}catch(i){throw t.exitScope(),i}}}}if(p){var h=i.getProperty("set").getValue()||o;if(h.isPrimitive&&void 0===h.value)u.set=u.setter=void 0;else{if("Function"!==h.className)throw new TypeError("Setter must be a function: "+a.toString(e.env,h));u.set=h,u.setter=function(){var t=e.env.setScope(f),r=a.toObject(e.env,this);try{return s.executeFunction(e,h,h.node.params,arguments,r,h.node),t.exitScope(),o}catch(n){throw t.exitScope(),n}}}}c&&(u.value=i.getProperty("value").getValue()||o)}t.defineOwnProperty(r,u,!0,e.env)}var o=e("../types/object-type"),a=e("../utils/convert"),u=e("../utils/contracts"),s=e("../utils/func");t.exports=function(e){var t=e.global,r=e.objectFactory,n=t.getProperty("undefined").getValue(),s=new o,c=r.createFunction(function(e){if(e){if(e.isPrimitive){if(null==e.value)return r.createObject();var t=r.createPrimitive(e.value);return t.type="object",t.isPrimitive=!1,t}return e}return r.createObject()},s,{configurable:!1,enumerable:!1,writable:!1});s.define("hasOwnProperty",r.createBuiltInFunction(function(t){return t=a.toString(e,t),r.createPrimitive(t in this.node.properties)},1,"Object.prototype.hasOwnProperty")),s.define("valueOf",r.createBuiltInFunction(function(){return a.toObject(e,this.node)},0,"Object.prototype.valueOf"));var l=r.createBuiltInFunction(function(){return r.createPrimitive("[object "+this.node.className+"]")},0,"Object.prototype.toString");s.define("toString",l),s.define("toLocaleString",l),s.define("isPrototypeOf",r.createBuiltInFunction(function(e){for(var t=e,n=this.env.current.thisNode;t;){if(n===t)return r.createPrimitive(!0);t=t.getPrototype()}return r.createPrimitive(!1)},1,"Object.isPrototypeOf")),s.define("propertyIsEnumerable",r.createBuiltInFunction(function(t){t=a.toPrimitive(e,t,"string");var n=this.node.getOwnProperty(t);return r.createPrimitive(!(!n||!n.enumerable))},1,"Object.propertyIsEnumerable")),c.define("create",r.createBuiltInFunction(function(t,n){if(t&&t.isPrimitive&&null!==t.value)throw new TypeError("Object prototype may only be an Object or null:"+a.toString(e,t));if(n&&n.isPrimitive&&null===n.value)throw new TypeError("Cannot convert null or undefined to object");var o=r.createObject();if(t&&o.setPrototype(t),n)for(var u in n.properties)n.properties[u].enumerable&&i(this,o,u,n.getProperty(u).getValue());return o},2,"Object.create")),c.define("defineProperty",r.createBuiltInFunction(function(t,r,n){return u.assertIsObject(t,"Object.defineProperty"),i(this,t,a.toString(e,r),n),t},3,"Object.defineProperty")),c.define("defineProperties",r.createBuiltInFunction(function(e,t){u.assertIsObject(e,"Object.defineProperties"),u.assertArgIsNotNullOrUndefined(t);for(var r in t.properties)t.properties[r].enumerable&&i(this,e,r,t.getProperty(r).getValue());return e},2,"Object.defineProperties")),c.define("getOwnPropertyDescriptor",r.createBuiltInFunction(function(t,i){if(u.assertIsObject(t,"Object.getOwnPropertyDescriptor"),i=a.toString(e,i),t.hasOwnProperty(i)){var o=t.getProperty(i),s=r.createObject();return s.putValue("configurable",r.createPrimitive(o.configurable),!1,this),s.putValue("enumerable",r.createPrimitive(o.enumerable),!1,this),o.dataProperty?(s.putValue("value",o.value,!1,this),s.putValue("writable",r.createPrimitive(o.writable),!1,this)):(s.putValue("get",o.get||n,!1,this),s.putValue("set",o.set||n,!1,this)),s}return n},2,"Object.getOwnPropertyDescriptor")),c.define("keys",r.createBuiltInFunction(function(t){u.assertIsObject(t);var n=r.create("Array"),i=0;for(var o in t.properties)t.properties[o].enumerable&&n.defineOwnProperty(i++,{
configurable:!0,enumerable:!0,writable:!0,value:r.createPrimitive(o)},!1,e);return n},1,"Object.keys")),c.define("getOwnPropertyNames",r.createBuiltInFunction(function(e){u.assertIsObject(e,"Object.getOwnPropertyNames");var t=r.create("Array");return e.getOwnPropertyNames().forEach(function(e,n){t.putValue(n,r.createPrimitive(e))}),t},1,"Object.getOwnPropertyNames")),c.define("getPrototypeOf",r.createBuiltInFunction(function(t){u.assertIsObject(t,"Object.getPrototypeOf");var r=t.getPrototype();return r||e.global.getProperty("null").getValue()},1,"Object.getPrototypeOf")),c.define("freeze",r.createBuiltInFunction(function(e){return u.assertIsObject(e,"Object.freeze"),e.freeze(),e},1,"Object.freeze")),c.define("isFrozen",r.createBuiltInFunction(function(e){if(u.assertIsObject(e,"Object.isFrozen"),e.isPrimitive)return r.createPrimitive(!0);if(!e.extensible)for(var t in e.properties)if(e.properties[t].writable||e.properties[t].configurable)return r.createPrimitive(!1);return r.createPrimitive(!e.extensible)},1,"Object.isFrozen")),c.define("preventExtensions",r.createBuiltInFunction(function(e){return u.assertIsObject(e,"Object.preventExtensions"),e.preventExtensions(),e},1,"Object.preventExtensions")),c.define("isExtensible",r.createBuiltInFunction(function(e){return u.assertIsObject(e,"Object.isExtensible"),r.createPrimitive(e.extensible)},1,"Object.isExtensible")),c.define("seal",r.createBuiltInFunction(function(e){return u.assertIsObject(e,"Object.seal"),e.seal(),e},1,"Object.seal")),c.define("isSealed",r.createBuiltInFunction(function(e){if(u.assertIsObject(e,"Object.isSealed"),!e.extensible)for(var t in e.properties)if(e.properties[t].configurable)return r.createPrimitive(!1);return r.createPrimitive(!e.extensible)},1,"Object.isSealed")),t.getProperty("Function").getValue().getPrototype().setPrototype(s),t.define("Object",c)}},{"../types/object-type":63,"../utils/contracts":68,"../utils/convert":69,"../utils/func":70}],13:[function(e,t,r){"use strict";var n=e("../utils/convert"),i=e("../utils/contracts");t.exports=function(e){var t=e.global,r=e.objectFactory,o=r.createFunction(function(t,o){if(t&&"RegExp"===t.className){if(!i.isUndefined(o))throw new TypeError("Cannot supply flags when constructing one RegExp from another");return t}var a=i.isUndefined(t)?"":n.toString(e,t);return o=i.isUndefined(o)?"":n.toString(e,o),r.create("RegExp",new RegExp(a,o))},null,{configurable:!1,enumerable:!1,writable:!1}),a=o.getProperty("prototype").getValue();a.className="RegExp",a.define("test",r.createBuiltInFunction(function(t){var i=n.toString(e,t);this.node.source.lastIndex=n.toInt32(e,this.node.getProperty("lastIndex").getValue());var o=this.node.source.test(i);return this.node.putValue("lastIndex",r.createPrimitive(this.node.source.lastIndex)),r.createPrimitive(o)},1,"RegExp.prototype.test")),a.define("exec",r.createBuiltInFunction(function(t){var i=n.toString(e,t);this.node.source.lastIndex=n.toInt32(e,this.node.getProperty("lastIndex").getValue());var o=this.node.source.exec(i);if(this.node.putValue("lastIndex",r.createPrimitive(this.node.source.lastIndex)),o){for(var a=r.create("Array"),u=0,s=o.length;s>u;u++)a.putValue(u,r.createPrimitive(o[u]));return a.putValue("index",r.createPrimitive(o.index),!1,this),a.putValue("input",r.createPrimitive(o.input),!1,this),a}return this.env.global.getProperty("null").getValue()},1,"RegExp.prototype.exec")),a.define("toString",r.createBuiltInFunction(function(){return r.createPrimitive(String(this.node.source))},0,"RegExp.prototype.toString")),a.define("compile",n.toNativeFunction(e,RegExp.prototype.compile,"RegExp.prototype.compile")),a.defineOwnProperty("lastIndex",{value:r.createPrimitive(0),writable:!0}),["global","ignoreCase","multiline","source"].forEach(function(e){a.defineOwnProperty(e,{value:r.createPrimitive(RegExp.prototype[e])})}),t.define("RegExp",o)}},{"../utils/contracts":68,"../utils/convert":69}],14:[function(e,t,r){"use strict";var n=e("../utils/contracts"),i=e("../utils/convert"),o=e("../utils/func"),a=["charAt","charCodeAt","concat","indexOf","lastIndexOf","localeCompare","substr","toLocaleLowerCase","toLocaleUpperCase","toLowerCase","toUpperCase"],u=Array.prototype.slice;t.exports=function(e){var t=e.global,r=e.objectFactory,s=r.createFunction(function(t){var n=t?i.toString(e,t.getValue()):"";return this.isNew?i.primitiveToObject(e,n):r.createPrimitive(n)},null,{configurable:!1,enumerable:!1,writable:!1}),c=s.getProperty("prototype").getValue();c.value="",c.className="String",c.defineOwnProperty("length",{value:r.createPrimitive(0)}),c.define("search",r.createBuiltInFunction(function(t){var n,o=i.toString(e,this.node);return t&&(n="RegExp"===t.className?t.source:new RegExp(i.toString(e,t))),r.createPrimitive(o.search(n))},1,"String.prototype.search")),c.define("substring",r.createBuiltInFunction(function(t,o){n.assertIsNotConstructor(this,"substring");var a=i.toPrimitive(e,this.node,"string"),u=a.length;return t=i.toInteger(e,t),o=n.isNullOrUndefined(o)?u:i.toInteger(e,o),r.createPrimitive(a.substring(t,o))},2,"String.prototype.substring")),a.forEach(function(t){var n=String.prototype[t];n&&c.define(t,r.createBuiltInFunction(function(){var n=i.toString(e,this.node),o=u.call(arguments).map(function(t){return i.toPrimitive(e,t)});return r.createPrimitive(String.prototype[t].apply(n,o))},String.prototype[t].length,"String.prototype."+t))}),s.define("fromCharCode",r.createBuiltInFunction(function(t){var n=u.call(arguments).map(function(t){return i.toPrimitive(e,t)});return r.createPrimitive(String.fromCharCode.apply(null,n))},1,"String.fromCharCode")),c.define("slice",r.createBuiltInFunction(function(t,o){var a,u=i.toString(e,this.node),s=i.toInteger(e,t);return n.isNullOrUndefined(o)||(a=i.toInteger(e,o)),r.createPrimitive(u.slice(s,a))},2,"String.prototype.slice")),c.define("split",r.createBuiltInFunction(function(t,o){var a=i.toString(e,this.node);t=t&&t.getValue(),o=o&&o.getValue();var u=n.isUndefined(o)?void 0:i.toUInt32(e,o),s=r.create("Array");if(n.isUndefined(t))s.putValue(0,r.createPrimitive(a),!1,this);else{var c;c="RegExp"===t.className?t.source:i.toString(e,t);var l=a.split(c,u),p=this;l.forEach(function(e,t){s.putValue(t,r.createPrimitive(e),!1,p)})}return s},2,"String.prototype.split")),c.define("replace",r.createBuiltInFunction(function(n,a){var s,c=i.toString(e,this.node);s=n&&"RegExp"===n.className?n.source:i.toString(e,n);var l;if(a&&"function"===a.type){var p=this,f=a["native"]?a:a.node,v=f.params||[];l=function(){var n=u.call(arguments).map(function(e){return r.createPrimitive(e)}),s=o.executeFunction(p,a,v,n,t,f);return s?i.toString(e,s):void 0}}else l=i.toString(e,a);return r.createPrimitive(c.replace(s,l))},2,"String.prototype.replace")),c.define("match",r.createBuiltInFunction(function(n){var o,a=i.toString(e,this.node);n&&"RegExp"===n.className?o=n.source:n&&(o=new RegExp(i.toPrimitive(e,n)));var u=a.match(o);if(u){var s=r.create("Array"),c=this;return u.forEach(function(e,t){s.putValue(t,r.createPrimitive(e),!1,c)}),s.putValue("index",r.createPrimitive(u.index),!1,this),s.putValue("input",r.createPrimitive(u.input),!1,this),s}return t.getProperty("null").getValue()},1,"String.prototype.match")),c.define("trim",r.createBuiltInFunction(function(){n.assertIsNotNullOrUndefined(this.node,"String.prototype.trim");var t=i.toPrimitive(e,this.node,"string");return r.createPrimitive(t.trim())},0,"String.prototype.trim")),c.define("toString",r.createBuiltInFunction(function(){if("String"!==this.node.className)throw new TypeError("String.prototype.toString is not generic");return r.createPrimitive(this.node.value)},0,"String.prototype.toString")),c.define("valueOf",r.createBuiltInFunction(function(){if("String"!==this.node.className)throw new TypeError("String.prototype.valueOf is not generic");return r.createPrimitive(this.node.value)},0,"String.prototype.valueOf")),t.define("String",s)}},{"../utils/contracts":68,"../utils/convert":69,"../utils/func":70}],15:[function(e,t,r){"use strict";function n(e,t,r){this.properties=Object.create(null),this.parent=e,this.thisNode=t,this.env=r}var i=e("./reference"),o=e("../types/property-descriptor");n.prototype={constructor:n,getReference:function(e,t){return new i(e,this,t,this.env)},hasVariable:function(e){return e in this.properties},createVariable:function(e){return this.hasVariable(e)?this.properties[e]:this.properties[e]=new o(this,{value:void 0,configurable:!1,enumerable:!0,writable:!0})},putValue:function(e,t,r){if(this.hasVariable(e)){if(!this.properties[e].writable){if(r)throw new TypeError("Cannot write to immutable binding: "+e);return}this.properties[e].setValue(t)}},getValue:function(e,t){if(this.hasVariable(e)){if(!this.properties[e].value){if(t)throw new ReferenceError(e+" is not defined");return void 0}return this.properties[e].getValue()}},deleteVariable:function(e){return this.hasVariable(e)?this.properties[e].configurable?(delete this.properties[e],!0):!1:!0},getThisBinding:function(){return this.thisNode}},t.exports=n},{"../types/property-descriptor":65,"./reference":19}],16:[function(e,t,r){"use strict";function n(e,t,r){if(Array.isArray(e))return void e.forEach(function(e){n(e,t,r)});if(e&&"object"==typeof e){if(e.type){if("VariableDeclaration"===e.type)return void n(e.declarations,t,e);if("VariableDeclarator"===e.type||"FunctionDeclaration"===e.type)return void t.push({decl:e,parent:r});if("ForInStatement"===e.type&&"Identifier"===e.left.type&&t.push({decl:e.left,parent:e}),"IfStatement"===e.type)return n(e.consequent,t,e),void n(e.alternate,t,e);if(f[e.type])return}var i;for(i in e)e.hasOwnProperty(i)&&e[i]&&"object"==typeof e[i]&&n(e[i],t,"type"in e?e:r)}}function i(e){return Array.isArray(e)?i(e[0]):e&&"ExpressionStatement"===e.type&&"Literal"===e.expression.type&&"use strict"===e.expression.value}function o(e){this.runner=e}var a=e("./declarative-environment"),u=e("./object-environment"),s=e("../execution-context"),c=e("./reference"),l=e("../keywords"),p=e("../ecma-5.1"),f={CallExpression:!0,NewExpression:!0,FunctionExpression:!0,WithStatement:!0};o.prototype={constructor:o,init:function(e){this.current=null,this.globalScope=null,p(this,e)},getReference:function(e,t){for(var r=this.current;r;){if(r.hasVariable(e))return r.getReference(e,t);r=r.parent}return new c(e,void 0,t,this)},getValue:function(e){return this.getReference(e).getValue()},putValue:function(e,t,r){this.current.putValue(e,t,r)},createVariable:function(e,t){if(l.isReserved(e))throw new SyntaxError("Illegal use of reserved keyword: "+e);this.current.createVariable(e,!t)},hasVariable:function(e){return this.current.hasVariable(e)},deleteVariable:function(e){this.current.deleteVariable(e)},getThisBinding:function(){return this.current.getThisBinding()||this.global},createExecutionContext:function(e,t){return new s(this,e,t)},createScope:function(e){var t=new a(this.current,e,this);return this.setScope(t)},createObjectScope:function(e){var t=new u(this.current,e,this);return this.setScope(t)},initScope:function(e){var t,r=this,o=i(e),a=this.global.getProperty("undefined").getValue(),u=[];n(e,u,e),u.forEach(function(e){var n=e.decl;if(t=n.name||n.id.name,"FunctionDeclaration"===n.type){var i=r.objectFactory.createFunction(n);i.bindScope(r.current),r.createVariable(t,!0),r.putValue(t,i,o)}else r.hasVariable(t)?r.putValue(t,a,o):r.createVariable(t,!0)})},setScope:function(e){this.globalScope=this.globalScope||e;var t=this,r=this.current||this.globalScope;return this.current=e,{init:function(e){e&&t.initScope(e)},exitScope:function(){t.setScope(r)}}}},t.exports=o},{"../ecma-5.1":8,"../execution-context":20,"../keywords":55,"./declarative-environment":15,"./object-environment":17,"./reference":19}],17:[function(e,t,r){"use strict";function n(e,t,r){this.parent=e,this.object=this.thisNode=t,this.env=r}var i=e("./property-reference");n.prototype={constructor:n,getReference:function(e,t){return new i(e,this.object,t,this.env)},hasVariable:function(e){return this.object.hasProperty(e)},createVariable:function(e,t){this.parent?this.parent.createVariable.apply(this.parent,arguments):this.object.defineOwnProperty(e,{value:void 0,configurable:t,enumerable:!0,writable:!0},!0)},putValue:function(e,t,r){this.parent&&!this.object.hasProperty(e)?this.parent.putValue.apply(this.parent,arguments):this.object.putValue(e,t,r)},getValue:function(e,t){if(!this.hasVariable(e)){if(t)throw new ReferenceError(e+" is not defined.");return void 0}return this.object.getProperty(e).getValue()},deleteVariable:function(e){return this.object.deleteProperty(e,!1)},getThisBinding:function(){return this.object}},t.exports=n},{"./property-reference":18}],18:[function(e,t,r){"use strict";function n(e,t,r,n){i.apply(this,arguments),this.isPropertyReference=!0}var i=e("./reference"),o=e("../types/primitive-type");n.prototype=Object.create(i.prototype),n.prototype.constructor=n,n.prototype.getValue=function(){var e=this.base.getProperty(this.name);return e&&e.getValue()||new o(void 0)},n.prototype.putValue=function(e){this.base.hasProperty(this.name)?this.base.putValue(this.name,e,this.strict,this.env):this.base.defineOwnProperty(this.name,{value:e,configurable:!0,enumerable:!0,writable:!0},this.strict,this.env)},n.prototype.deleteBinding=function(e){return this.base.deleteProperty(e,!0)},n.prototype.isUnresolved=function(){return!1},t.exports=n},{"../types/primitive-type":64,"./reference":19}],19:[function(e,t,r){"use strict";function n(e,t,r,n){this.name=e,this.base=t,this.strict=r,this.env=n}n.prototype={constructor:n,putValue:function(e){if(void 0===this.base&&this.strict)throw new ReferenceError(this.name+" is not defined");this.base?this.base.putValue(this.name,e,this.strict):this.env.global.defineOwnProperty(this.name,{value:e,configurable:!0,enumerable:!0,writable:!0},!1)},getValue:function(){if(!this.base)throw new ReferenceError(this.name+" is not defined");return this.base.getValue(this.name,this.strict)},deleteBinding:function(e){return this.base?this.base.deleteVariable(e):!0},isUnresolved:function(){return!this.base}},t.exports=n},{}],20:[function(e,t,r){"use strict";function n(e,t,r){this.node=t,this.callee=r,this.env=e,this.label="",this.value=null,this.isNew=!1,this.strict=!1}var i=e("./execution-result");n.prototype.execute=function(){return this.env.runner.execute(this)},n.prototype.create=function(e,t,r){var i=new n(this.env,e,t||this.callee);return i.value=this.value,i.isNew=!!r,i},n.prototype.createLabel=function(e,t){var r=this.create(e);return r.label=t,r},n.prototype.cancel=function(e){var t=this.result(this.value,e);return t.cancel=!0,t},n.prototype.skip=function(e){var t=this.result(this.value,e);return t.skip=!0,t},n.prototype.exit=function(e){this.callee=null;var t=this.result(e);return t.exit=!0,t},n.prototype.result=function(e,t,r){return this.value=e,new i(e,t,r)},n.prototype.empty=function(){return this.result()},t.exports=n},{"./execution-result":21}],21:[function(e,t,r){"use strict";function n(e,t,r){this.result=e,this.name=t,this.object=r,this.cancel=!1,this.cancelled=!1,this.exit=!1,this.skip=!1}n.prototype.isCancelled=function(){return this.cancel||this.exit},n.prototype.shouldBreak=function(e,t,r){if(this.exit)return!0;if(!this.cancel&&!this.skip)return!1;var n=!0;return this.name&&this.name===e.label?(n=this.cancelled=this.cancel,this.cancel=this.skip=!1,this.cancelled&&(this.result=r&&r.result||this.result),n):(t&&!this.name&&(n=this.cancelled=this.cancel,this.cancel=this.skip=!1),this.result=r&&r.result||this.result,n)},t.exports=n},{}],22:[function(e,t,r){"use strict";t.exports=function(e){var t=e.env.objectFactory,r=t.create("Array");if(e.node.elements){for(var n=0,i=e.node.elements.length;i>n;){if(e.node.elements[n]){var o=e.create(e.node.elements[n]).execute().result.getValue();r.defineOwnProperty(n,{value:o,configurable:!0,enumerable:!0,writable:!0},!0,e.env)}n++}r.putValue("length",t.createPrimitive(i),!1,e)}return e.result(r)}},{}],23:[function(e,t,r){"use strict";var n=e("../env/reference"),i={"+=":function(e,t){return e.value+t.value},"-=":function(e,t){return e.value-t.value},"*=":function(e,t){return e.value*t.value},"/=":function(e,t){return e.value/t.value},"%=":function(e,t){return e.value%t.value},"<<=":function(e,t){return e.value<<t.value},">>=":function(e,t){return e.value>>t.value},">>>=":function(e,t){return e.value>>>t.value},"|=":function(e,t){return e.value|t.value},"^=":function(e,t){return e.value^t.value},"&=":function(e,t){return e.value&t.value}};t.exports=function(e){var t="="===e.node.operator,r=e.create(e.node.right).execute().result,o=e.create(e.node.left).execute().result;if(!(o instanceof n))throw new ReferenceError("Invalid left-hand side in assignment");var a;if(t)a=r.getValue();else{var u=i[e.node.operator](o.getValue(),r.getValue());a=e.env.objectFactory.createPrimitive(u)}return o.putValue(a),e.result(a)}},{"../env/reference":19}],24:[function(e,t,r){"use strict";function n(e,t,r){if(e.isPrimitive&&t.isPrimitive)return e.value==t.value;if("object"===e.type&&"object"===t.type||"function"===e.type&&"function"===t.type)return e===t;var n=s.toPrimitive(r,e),i=s.toPrimitive(r,t);return"number"==typeof n||"number"==typeof i||"boolean"==typeof n||"boolean"==typeof i?Number(n)===Number(i):"string"==typeof n?n===s.toPrimitive(r,t,"string"):"string"==typeof i?s.toPrimitive(r,e,"string")===i:n==i}function i(e,t){return e.isPrimitive&&t.isPrimitive?e.value===t.value:e.isPrimitive||t.isPrimitive?!1:e===t}function o(e){return function(t,r,n){return!e(t,r,n)}}function a(e,t,r){return e.isPrimitive&&t.isPrimitive?e.value+t.value:(e=s.toPrimitive(r,e),t=s.toPrimitive(r,t),e+t)}function u(e,t){return"Number"===t.className?t.value:s.toNumber(e,t)}var s=e("../utils/convert"),c={"+":a,"-":function(e,t,r){return u(r,e)-u(r,t)},"/":function(e,t,r){return u(r,e)/u(r,t)},"*":function(e,t,r){return u(r,e)*u(r,t)},"==":n,"!=":o(n),"===":i,"!==":o(i),"<":function(e,t,r){return s.toPrimitive(r,e)<s.toPrimitive(r,t)},"<=":function(e,t,r){return s.toPrimitive(r,e)<=s.toPrimitive(r,t)},">":function(e,t,r){return s.toPrimitive(r,e)>s.toPrimitive(r,t)},">=":function(e,t,r){return s.toPrimitive(r,e)>=s.toPrimitive(r,t)},"<<":function(e,t,r){return s.toPrimitive(r,e)<<s.toPrimitive(r,t)},">>":function(e,t,r){return s.toPrimitive(r,e)>>s.toPrimitive(r,t)},">>>":function(e,t,r){return s.toPrimitive(r,e)>>>s.toPrimitive(r,t)},"%":function(e,t,r){return s.toPrimitive(r,e)%s.toPrimitive(r,t)},"|":function(e,t,r){return s.toInt32(r,e)|s.toInt32(r,t)},"^":function(e,t,r){return s.toInt32(r,e)^s.toInt32(r,t)},"&":function(e,t,r){return s.toInt32(r,e)&s.toInt32(r,t)},"in":function(e,t,r){if(e=s.toString(r,e),t.isPrimitive)throw new TypeError("Cannot use 'in' operator to search for '"+e+"' in "+s.toString(r,t));return t.hasProperty(e)},"instanceof":function(e,t){if("function"!==t.type)throw new TypeError("Expecting a function in instanceof check, but got "+t.type);return e.isPrimitive?!1:t.hasInstance(e)}};t.exports=function(e){var t=e.env.global.getProperty("undefined").getValue(),r=e.create(e.node.left).execute().result,n=r.getValue()||t,i=e.create(e.node.right).execute().result,o=i.getValue()||t,a=c[e.node.operator](n,o,e.env);return e.result(e.env.objectFactory.createPrimitive(a))}},{"../utils/convert":69}],25:[function(e,t,r){"use strict";t.exports=function(e){var t,r;"Program"===e.node.type&&e.env.initScope(e.node.body);for(var n=0,i=e.node.body.length;i>n;n++){if(t=e.create(e.node.body[n]).execute(),t&&t.shouldBreak(e,!1,r))return t;r=t}return t}},{}],26:[function(e,t,r){"use strict";function n(e,t,r,n,o){return n?o?null:e.objectFactory.createObject(r):t instanceof i&&t.isPropertyReference?a.toObject(e,t.base):null}var i=e("../env/reference"),o=e("../utils/func"),a=e("../utils/convert");t.exports=function(e){var t=e.node,r="NewExpression"===e.node.type,i=e.create(t.callee).execute().result,u=i.getValue(),s=t.arguments.map(function(t){return e.create(t).execute().result.getValue()});if(!u||"Function"!==u.className)throw new TypeError(a.toString(e.env,u)+" not a function");var c=u["native"],l=n(e.env,i,u,r,c),p=c?[]:u.node.params,f=i;return f.identifier=u.name,e.result(o.executeFunction(e,u,p,s,l,f,r))}},{"../env/reference":19,"../utils/convert":69,"../utils/func":70}],27:[function(e,t,r){"use strict";t.exports=function(e){return e.empty()}},{}],28:[function(e,t,r){"use strict";var n=e("../utils/convert");t.exports=function(e){var t,r,i=!0;for("WhileStatement"===e.node.type&&(i=n.toBoolean(e.create(e.node.test).execute().result.getValue()));i;){if(t=e.create(e.node.body).execute(),t&&t.shouldBreak(e,!0,r))return t;i=n.toBoolean(e.create(e.node.test).execute().result.getValue()),r=t}return t}},{"../utils/convert":69}],29:[function(e,t,r){"use strict";t.exports=function(e){return e.empty()}},{}],30:[function(e,t,r){"use strict";t.exports=function(e){var t=e.create(e.node.expression).execute(),r=t&&t.result&&t.result.getValue();return e.result(r||e.env.global.getProperty("undefined").getValue())}},{}],31:[function(e,t,r){"use strict";t.exports=function(e){var t;"VariableDeclaration"===e.node.left.type?e.node.left.declarations.forEach(function(r){t=e.create(r).execute().result}):t=e.create(e.node.left).execute().result;for(var r,n,i=e.create(e.node.right).execute().result.getValue(),o=Object.create(null);i;){for(var a in i.properties){if(i.properties[a].enumerable&&!o[a]&&(t.putValue(e.env.objectFactory.createPrimitive(a)),r=e.create(e.node.body).execute(),r&&r.shouldBreak(e,!0,n)))return r;o[a]=!0}n=r,i=i.getPrototype()}return r}},{}],32:[function(e,t,r){"use strict";function n(e){return e.node.test?i.toBoolean(e.create(e.node.test).execute().result.getValue()):!0}var i=e("../utils/convert");t.exports=function(e){e.node.init&&e.create(e.node.init).execute();for(var t,r;n(e);){if(t=e.create(e.node.body).execute(),t&&t.shouldBreak(e,!0,r))return t;e.node.update&&e.create(e.node.update).execute(),r=t}return t}},{"../utils/convert":69}],33:[function(e,t,r){"use strict";t.exports=function(e){return e.result(e.env.getValue(e.node.id.name))}},{}],34:[function(e,t,r){"use strict";t.exports=function(e){var t=e.env.objectFactory,r=t.createFunction(e.node);return r.bindScope(e.env.current),e.node.id&&(r.name=e.node.id.name),e.result(r)}},{}],35:[function(e,t,r){"use strict";t.exports=function(e){var t=e.node.name;return e.result(e.callee&&e.callee.identifier===t?e.callee:e.env.getReference(e.node.name))}},{}],36:[function(e,t,r){"use strict";var n=e("../utils/convert");t.exports=function(e){var t=e.create(e.node.test).execute().result.getValue();return n.toBoolean(t)?e.create(e.node.consequent).execute():e.node.alternate?e.create(e.node.alternate).execute():void 0}},{"../utils/convert":69}],37:[function(e,t,r){"use strict";var n={};n.ArrayExpression=e("./array-expression"),n.AssignmentExpression=e("./assignment-expression"),n.BinaryExpression=e("./binary-expression"),n.BreakStatement=n.ContinueStatement=e("./interrupt-statement"),n.CallExpression=n.NewExpression=e("./call-expression"),n.ConditionalExpression=n.IfStatement=e("./if-statement"),n.DebuggerStatement=e("./debugger-statement"),n.DoWhileStatement=n.WhileStatement=e("./do-while-statement.js"),n.EmptyStatement=e("./empty-statement"),n.ExpressionStatement=e("./expression-statement"),n.ForStatement=e("./for-statement"),n.ForInStatement=e("./for-in-statement"),n.FunctionDeclaration=e("./function-declaration"),n.FunctionExpression=e("./function-expression"),n.Identifier=e("./identifier"),n.LabeledStatement=e("./labeled-statement"),n.Literal=e("./literal"),n.LogicalExpression=e("./logical-expression"),n.MemberExpression=e("./member-expression"),n.ObjectExpression=e("./object-expression"),n.Program=n.BlockStatement=e("./block-statement"),n.ReturnStatement=e("./return-statement"),n.SequenceExpression=e("./sequence-expression"),n.SwitchStatement=e("./switch-statement"),n.ThisExpression=e("./this-expression"),n.ThrowStatement=e("./throw-statement"),n.TryStatement=e("./try-statement"),n.UnaryExpression=e("./unary-expression"),n.UpdateExpression=e("./update-expression"),n.VariableDeclaration=e("./variable-declaration"),n.VariableDeclarator=e("./variable-declarator"),n.WithStatement=e("./with-statement"),t.exports=n},{"./array-expression":22,"./assignment-expression":23,"./binary-expression":24,"./block-statement":25,"./call-expression":26,"./debugger-statement":27,"./do-while-statement.js":28,"./empty-statement":29,"./expression-statement":30,"./for-in-statement":31,"./for-statement":32,"./function-declaration":33,"./function-expression":34,"./identifier":35,"./if-statement":36,"./interrupt-statement":38,"./labeled-statement":39,"./literal":40,"./logical-expression":41,"./member-expression":42,"./object-expression":43,"./return-statement":44,"./sequence-expression":45,"./switch-statement":46,"./this-expression":47,"./throw-statement":48,"./try-statement":49,"./unary-expression":50,"./update-expression":51,"./variable-declaration":52,"./variable-declarator":53,"./with-statement":54}],38:[function(e,t,r){"use strict";t.exports=function(e){var t;return e.node.label&&(t=e.node.label.name),"BreakStatement"===e.node.type?e.cancel(t):e.skip(t)}},{}],39:[function(e,t,r){"use strict";t.exports=function(e){return e.createLabel(e.node.body,e.node.label.name).execute()}},{}],40:[function(e,t,r){"use strict";t.exports=function(e){return e.result(e.env.objectFactory.createPrimitive(e.node.value))}},{}],41:[function(e,t,r){"use strict";var n=e("../utils/convert");t.exports=function(e){var t=e.create(e.node.left).execute(),r=n.toBoolean(t.result.getValue());return r&&"||"===e.node.operator?t:r||"&&"!==e.node.operator?e.create(e.node.right).execute():t}},{"../utils/convert":69}],42:[function(e,t,r){"use strict";var n=e("../utils/convert"),i=e("../env/property-reference");t.exports=function(e){var t,r,o=e.create(e.node.object).execute().result.getValue();return t=e.node.computed?n.toString(e.env,e.create(e.node.property).execute().result.getValue()):e.node.property.name,r=new i(t,o,!1,e.env),e.result(r)}},{"../env/property-reference":18,"../utils/convert":69}],43:[function(e,t,r){"use strict";function n(e,t,r,n){n.get&&(n.getter=function(){return o.executeFunction(e,n.get,n.get.node.params,[],this,n.get.node)}),n.set&&(n.setter=function(){o.executeFunction(e,n.set,n.set.node.params,arguments,this,n.set.node)}),t.defineOwnProperty(r,n)}function i(e){return{value:e,configurable:!0,enumerable:!0,writable:!0}}var o=e("../utils/func");t.exports=function(e){var t=e.env.objectFactory.createObject(),r=Object.create(null);e.node.properties.forEach(function(n){var o=e.create(n.value).execute().result.getValue(),a=n.key.name||n.key.value;switch(n.kind){case"get":case"set":r[a]=r[a]||i(),r[a][n.kind]=o;break;default:t.defineOwnProperty(a,i(o))}});for(var o in r)n(e,t,o,r[o]);return e.result(t)}},{"../utils/func":70}],44:[function(e,t,r){"use strict";t.exports=function(e){return e.exit(e.node.argument?e.create(e.node.argument).execute().result.getValue():e.env.global.getProperty("undefined").getValue())}},{}],45:[function(e,t,r){"use strict";t.exports=function(e){var t;return e.node.expressions.forEach(function(r){t=e.create(r).execute().result.getValue()}),e.result(t)}},{}],46:[function(e,t,r){"use strict";function n(e,t){for(var r,n=0,i=t.length;i>n;n++)if(r=e.create(t[n]).execute(),r&&r.isCancelled())return r;return r}t.exports=function(e){for(var t,r,i,o=e.create(e.node.discriminant).execute().result.getValue(),a=!1,u=0,s=e.node.cases.length;s>u;u++){if(!a){if(!e.node.cases[u].test){i=e.node.cases[u];continue}if(t=e.create(e.node.cases[u].test).execute().result.getValue(),!t.equals(o))continue}if(a=!0,r=n(e,e.node.cases[u].consequent),r&&r.isCancelled())return r.cancel=!1,r}return!a&&i&&i.consequent?(r=n(e,i.consequent),r.cancel=!1,r):r}},{}],47:[function(e,t,r){"use strict";t.exports=function(e){return e.result(e.env.getThisBinding())}},{}],48:[function(e,t,r){"use strict";t.exports=function(e){var t=e.create(e.node.argument).execute().result.getValue();if(t.isPrimitive)throw t.value;var r=new Error;throw r.wrappedError=t,r}},{}],49:[function(e,t,r){"use strict";t.exports=function(e){var t;try{t=e.create(e.node.block).execute()}catch(r){if(!e.node.handler)throw r;var n=r&&r.wrappedError||e.env.objectFactory.createPrimitive(r),i=e.node.handler.param.name,o=e.env.hasVariable(i);o||e.env.createVariable(i),e.env.putValue(i,n);try{t=e.create(e.node.handler.body,e.node.handler).execute()}catch(a){throw a}finally{o||e.env.deleteVariable(i)}}finally{if(e.node.finalizer){var u=e.create(e.node.finalizer).execute();if(u&&u.shouldBreak(e))return u}}return t}},{}],50:[function(e,t,r){"use strict";var n=e("../env/reference"),i=e("../utils/convert");t.exports=function(e){var t,r,o=e.create(e.node.argument).execute().result,a=e.env.objectFactory;switch(e.node.operator){case"typeof":var u;o instanceof n&&o.isUnresolved()?u="undefined":(t=o.getValue(),u=t?t.type:"undefined"),r=a.createPrimitive(u);break;case"-":t=o.getValue(),r=a.createPrimitive(-i.toNumber(e.env,t));break;case"+":t=o.getValue(),r=a.createPrimitive(+i.toNumber(e.env,t));break;case"!":t=o.getValue(),r=a.createPrimitive(!i.toBoolean(t));break;case"~":t=o.getValue(),r=a.createPrimitive(~i.toInt32(e.env,t));break;case"delete":var s=!0;if(o&&o instanceof n)o.isUnresolved()||(s=o.deleteBinding(o.name));else if(e.node.argument.object)throw new ReferenceError(e.node.argument.object.name+" is not defined");r=a.createPrimitive(s);break;case"void":r=a.createPrimitive(void 0);break;default:throw new SyntaxError("Unknown unary operator: "+e.node.operator)}return e.result(r)}},{"../env/reference":19,"../utils/convert":69}],51:[function(e,t,r){"use strict";var n=e("../utils/convert");t.exports=function(e){var t=e.env.objectFactory,r=e.create(e.node.argument).execute().result,i=n.toNumber(e.env,r.getValue()),o=i;"++"===e.node.operator?o++:o--,o=t.createPrimitive(o),i=t.createPrimitive(i);var a=e.node.prefix?o:i;return r.putValue(o),e.result(a)}},{"../utils/convert":69}],52:[function(e,t,r){"use strict";t.exports=function(e){return e.node.declarations.forEach(function(t){e.create(t).execute()}),e.empty()}},{}],53:[function(e,t,r){"use strict";t.exports=function(e){var t,r=e.node.id.name;return e.node.init&&(t=e.create(e.node.init).execute().result),t&&e.env.putValue(r,t.getValue(),!1,e),e.result(e.env.getReference(r))}},{}],54:[function(e,t,r){"use strict";t.exports=function(e){var t,r=e.create(e.node.object).execute().result.getValue(),n=e.env.createObjectScope(r);n.init(e.node.body);try{t=e.create(e.node.body).execute()}catch(i){throw n.exitScope(),i}return n.exitScope(),t}},{}],55:[function(e,t,r){"use strict";t.exports={es5:["do","if","in","for","new","try","var","case","else","enum","null","this","true","void","with","break","catch","class","const","false","super","throw","while","delete","export","import","return","switch","typeof","default","extends","finally","continue","debugger","function","instanceof"],"es5-strict":["implements","let","private","public","interface","package","protected","static","yield"],isReserved:function(e,t){return this.es5.indexOf(e)>=0}}},{}],56:[function(e,t,r){"use strict";function n(){i.call(this),this.className="Arguments",this.parameterMap=Object.create(null)}var i=e("./object-type");n.prototype=Object.create(i.prototype),n.prototype.constructor=n,n.prototype.mapProperty=function(e,t){e=String(e),i.prototype.defineOwnProperty.call(this,e,{configurable:!0,enumerable:!0,writable:!0,value:void 0},!0),this.parameterMap[e]=t},n.prototype.getProperty=function(e){var t=this.getOwnProperty(e);return t?t:i.prototype.getProperty.apply(this,arguments)},n.prototype.getOwnProperty=function(e){if(e=String(e),e in this.parameterMap){var t=this.properties[e],r=this.parameterMap[e];return t.value=r.getValue(),t.setValue=r.setValue.bind(r),t}return i.prototype.getOwnProperty.apply(this,arguments)},n.prototype.defineOwnProperty=function(e,t,r){e=String(e);var n=i.prototype.defineOwnProperty.apply(this,arguments);return n&&e in this.parameterMap&&("set"in t||"get"in t?delete this.parameterMap[e]:"value"in t&&this.parameterMap[e].setValue(t.value,r),
"writable"in t&&!t.writable&&delete this.parameterMap[e]),n},n.prototype.deleteProperty=function(e,t){return e=String(e),e in this.parameterMap&&delete this.parameterMap[e],i.prototype.deleteProperty.apply(this,arguments)},t.exports=n},{"./object-type":63}],57:[function(e,t,r){"use strict";function n(e,t,r,n,i){var o=Number(r),s=t.getProperty("length"),c=s.getValue().value;if(!s.canSetValue()&&o>=c||!u.prototype.defineOwnProperty.call(t,r,n,!1,e)){if(i)throw new TypeError("Cannot define property: "+r+", object is not extensible.");return!1}if(o>=c){var l=a.createPrimitive(o+1);t.defineOwnProperty("length",{value:l},!1,e)}return!0}function i(e,t,r,n,i){var o=c.toUInt32(e,n.value);if(o!==c.toNumber(e,n.value))throw new RangeError("Array length out of range");n.value=a.createPrimitive(o);var l=n.value,p=t.getProperty("length").getValue();if(s.assertIsValidArrayLength(l.value),l.value>=p.value)return u.prototype.defineOwnProperty.call(t,r,n,i);if(t.properties.length.writable===!1){if(i)throw new TypeError("Cannot redefine property: length");return!1}var f="writable"in n&&!n.writable;f&&(n.writable=!0);var v=p.value;if(!u.prototype.defineOwnProperty.call(t,r,n,i))return!1;for(var h=!0;v>l.value;)if(!t.deleteProperty(--v,!1)){l=a.createPrimitive(v+1),t.defineOwnProperty("length",{value:l},!1),h=!1;break}if(f&&t.defineOwnProperty("length",{writable:!1},!1),!h&&i)throw new TypeError("Cannot redefine property: length");return h}function o(){u.call(this),this.className="Array"}var a,u=e("./object-type"),s=e("../utils/contracts"),c=e("../utils/convert");o.prototype=Object.create(u.prototype),o.prototype.constructor=o,o.prototype.putValue=function(e,t,r,n){return"length"===e?void i(n,this,e,{value:t},r):void u.prototype.putValue.apply(this,arguments)},o.prototype.defineOwnProperty=function(e,t,r,o){return s.isInteger(e)&&s.isValidArrayLength(Number(e)+1)&&!this.hasOwnProperty(e)?n(o,this,e,t,r):"length"===e&&"length"in this.properties&&t&&"value"in t?i(o,this,e,t,r):u.prototype.defineOwnProperty.apply(this,arguments)},o.prototype.init=function(e){a=e,this.defineOwnProperty("length",{value:e.createPrimitive(0),configurable:!1,enumerable:!1,writable:!0})},t.exports=o},{"../utils/contracts":68,"../utils/convert":69,"./object-type":63}],58:[function(e,t,r){"use strict";function n(e){i.call(this),this.value=e,this.type="object",this.className="Date",this.primitiveHint="string"}var i=e("./object-type");n.prototype=Object.create(i.prototype),n.prototype.constructor=n,t.exports=n},{"./object-type":63}],59:[function(e,t,r){"use strict";function n(e){i.call(this),this.source=e,this.className="Error"}var i=e("./object-type");n.prototype=Object.create(i.prototype),n.prototype.constructor=n,t.exports=n},{"./object-type":63}],60:[function(e,t,r){"use strict";function n(e){i.call(this),this.type="function",this.className="Function",this["native"]=!1,this.node=e,this.parentScope=null,this.boundThis=null}var i=e("./object-type"),o=e("./property-descriptor"),a=e("../utils/contracts");n.prototype=Object.create(i.prototype),n.prototype.constructor=n,n.prototype.init=function(e,t,r){this.defineOwnProperty("length",{value:e.createPrimitive(this.node.params.length),configurable:!1,enumerable:!1,writable:!1}),t=t||e.createObject(),t.properties.constructor=new o(this,{configurable:!0,enumerable:!1,writable:!0,value:this}),this.defineOwnProperty("prototype",{value:t,configurable:!1,enumerable:!1,writable:!0})},n.prototype.getProperty=function(e){var t=i.prototype.getProperty.apply(this,arguments);if(!t&&"prototype"!==e){var r=this.getProperty("prototype");return r&&r.getValue().getProperty(e)}return t},n.prototype.bindThis=function(e){this.boundThis=e},n.prototype.bindScope=function(e){this.parentScope=e},n.prototype.createScope=function(e,t){var r=e.current;this.parentScope&&(e.current=this.parentScope);var n=Array.prototype.slice.call(arguments,1);this.boundThis&&(n[0]=this.boundThis);var i=e.createScope.apply(e,n);return this["native"]||i.init(this.node.body),{exitScope:function(){i.exitScope(),e.current=r}}},n.prototype.hasInstance=function(e){if(e===this)return!1;var t=[],r=e,n=this.getProperty("prototype").getValue();if(a.isNullOrUndefined(n)||!a.isObject(n))throw new TypeError("Function has non-object prototype in instanceof check");for(;r;){if(t.indexOf(r)>=0)return!1;if(r===n)return!0;t.push(r),r=r.getPrototype()}return!1},t.exports=n},{"../utils/contracts":68,"./object-type":63,"./property-descriptor":65}],61:[function(e,t,r){"use strict";function n(e){i.call(this),this.type="function",this["native"]=!0,this.nativeFunction=e}var i=e("./function-type"),o=e("./property-descriptor");n.prototype=Object.create(i.prototype),n.prototype.constructor=n,n.prototype.init=function(e,t,r){var n=this.nativeFunction.length;"nativeLength"in this.nativeFunction&&(n=this.nativeFunction.nativeLength),this.defineOwnProperty("length",{value:e.createPrimitive(n),configurable:!1,enumerable:!1,writable:!1}),t=t||e.createObject(),t.properties.constructor=new o(this,{configurable:!0,enumerable:!1,writable:!0,value:this}),r=r||{configurable:!1,enumerable:!1,writable:!0};var i={value:t,configurable:r.configurable,enumerable:r.enumerable,writable:r.writable};this.defineOwnProperty("prototype",i)},t.exports=n},{"./function-type":60,"./property-descriptor":65}],62:[function(e,t,r){"use strict";function n(e){var t;for(var r in m)t=e.getValue(r),t&&(m[r].forEach(function(e){e.setPrototype(t.getProperty("prototype").getValue())}),delete m[r]);m=Object.create(null)}function i(e,t,r){if(!(e in g)){var n=r.getReference(e);if(!n.isUnresolved())return void t.setPrototype(n.getValue().getProperty("prototype").getValue());m[e]=m[e]||[],m[e].push(t)}}function o(e){this.env=e}var a=e("./primitive-type"),u=e("./function-type"),s=e("./native-function-type"),c=e("./regex-type"),l=e("./object-type"),p=e("./array-type"),f=e("./string-type"),v=e("./date-type"),h=e("./error-type"),d=e("./argument-type"),y=e("../utils/contracts"),g={Undefined:!0,Null:!0,Function:!0},m=Object.create(null);o.prototype={constructor:o,init:function(){n(this.env)},createPrimitive:function(e){return this.create(y.getType(e),e)},create:function(e,t){var r;switch(e){case"String":r=new f(t);break;case"Number":case"Boolean":case"Null":case"Undefined":r=new a(t);break;case"Date":r=new v(t);break;case"RegExp":r=new c(t);break;case"Array":r=new p;break;case"Error":r=new h(t),t&&(e=t.name||e,r.defineOwnProperty("message",{value:this.createPrimitive(t.message),configurable:!0,enumerable:!1,writable:!0}));break;default:throw new Error("Not a primitive: "+t)}return r.init(this),i(e,r,this.env),r},createObject:function(e){var t=new l;return null!==e&&(e?t.setPrototype(e&&e.getProperty("prototype").getValue()):i("Object",t,this.env)),t.init(this),t},createArguments:function(e,t){var r=new d,n=this.env.global.getProperty("Object").getValue();return r.init(this,n,n.proto),r.setPrototype(n.getProperty("prototype").getValue()),r.defineOwnProperty("callee",{value:t,configurable:!0,enumerable:!1,writable:!0}),r},createFunction:function(e,t,r){var n;n="function"==typeof e?new s(e):new u(e),n.init(this,t,r);var i=this.env.getReference("Function");return i&&!i.isUnresolved()&&n.setPrototype(i.getValue().getProperty("prototype").getValue()),n},createBuiltInFunction:function(e,t,r){var n=new s(function(){if(this.isNew)throw new TypeError(r+" is not a constructor");return e.apply(this,arguments)});return n.setPrototype(this.env.getValue("Function").getProperty("prototype").getValue()),n.builtIn=!0,n.defineOwnProperty("length",{value:this.createPrimitive(t),configurable:!1,enumerable:!1,writable:!1}),n}},t.exports=o},{"../utils/contracts":68,"./argument-type":56,"./array-type":57,"./date-type":58,"./error-type":59,"./function-type":60,"./native-function-type":61,"./object-type":63,"./primitive-type":64,"./regex-type":66,"./string-type":67}],63:[function(e,t,r){"use strict";function n(){this.isPrimitive=!1,this.type="object",this.className="Object",this.properties=Object.create(null),this.extensible=!0,this.primitiveHint="number"}var i=e("./property-descriptor");n.prototype=n.fn={constructor:n,init:function(){},getPrototype:function(){return this.proto},setPrototype:function(e){this.proto=e},getProperty:function(e){e=String(e);for(var t=this;t;){if(e in t.properties)return t.properties[e].bind(this);t=t.getPrototype()}return void 0},getOwnProperty:function(e){return this.properties[String(e)]},getOwnPropertyNames:function(){return Object.keys(this.properties)},hasProperty:function(e){return!!this.getProperty(e)},hasOwnProperty:function(e){return String(e)in this.properties},putValue:function(e,t,r){if(!this.isPrimitive){e=String(e);var n=this.getProperty(e);if(n){if(!n.canSetValue()){if(r)throw new TypeError("Cannot assign to read only property '"+e+"' of %s");return}n.dataProperty&&!this.hasOwnProperty(e)?this.properties[e]=new i(this,{value:t,configurable:n.configurable,enumerable:n.enumerable,writable:n.writable}):n.setValue(t)}else this.defineOwnProperty(e,{value:t,configurable:!0,enumerable:!0,writable:!0},r)}},defineOwnProperty:function(e,t,r){if(this.isPrimitive){if(r)throw new TypeError("Cannot define property: "+e+", object is not extensible");return!1}var n=this.getOwnProperty(e);if(n){if(n.canUpdate(t))return n.update(t),!0;if(r)throw new TypeError("Cannot redefine property: "+e);return!1}if(!this.extensible){if(r)throw new TypeError("Cannot define property: "+e+", object is not extensible");return!1}return this.properties[e]=new i(this,t),!0},define:function(e,t,r){r=r||{configurable:!0,enumerable:!1,writable:!0},r.value=t,this.properties[e]=new i(this,r)},remove:function(e){delete this.properties[e]},getValue:function(){return this},deleteProperty:function(e){return this.isPrimitive?!1:e in this.properties&&!this.properties[e].configurable?!1:delete this.properties[e]},freeze:function(){for(var e in this.properties)this.properties[e].dataProperty?this.defineOwnProperty(e,{writable:!1,configurable:!1},!0):this.defineOwnProperty(e,{configurable:!1},!0);this.preventExtensions()},preventExtensions:function(){this.extensible=!1},seal:function(){for(var e in this.properties)this.defineOwnProperty(e,{configurable:!1},!0);this.preventExtensions()},equals:function(e){return this.isPrimitive&&e.isPrimitive?this.value===e.value:this===e}},t.exports=n},{"./property-descriptor":65}],64:[function(e,t,r){"use strict";function n(e){i.call(this),this.isPrimitive=!0,this.value=e,this.type=typeof e,this.className=o.getType(e)}var i=e("./object-type"),o=e("../utils/contracts");n.prototype=Object.create(i.prototype),n.prototype.constructor=n,n.prototype.getProperty=function(e){if(null==this.value)throw new TypeError("Cannot read property '"+e+"' of "+this.type);return i.prototype.getProperty.apply(this,arguments)},t.exports=n},{"../utils/contracts":68,"./object-type":63}],65:[function(e,t,r){"use strict";function n(e,t,r){t=t||o,this.base=e,this.configurable=t.configurable||!1,this.enumerable=t.enumerable||!1,"get"in t||"set"in t?(this.dataProperty=!1,this.get=t.get,this.getter=t.getter,this.set=t.set,this.setter=t.setter):(this.writable=t.writable||!1,this.dataProperty=!0,this.value=r||t.value)}var i=e("../utils/contracts"),o={configurable:!1,enumerable:!1,writable:!1};n.prototype={constructor:n,bind:function(e){return this.base=e,this},update:function(e){for(var t in e)e.hasOwnProperty(t)&&(this[t]=e[t]);"get"in e||"set"in e?(this.writable=void 0,this.dataProperty=!1,this.value=void 0):"value"in e&&(this.writable=void 0===this.writable?!1:this.writable,this.dataProperty=!0,this.get=this.getter=this.set=this.setter=void 0)},canUpdate:function(e){return this.configurable?!0:"configurable"in e&&this.configurable!==e.configurable?!1:"enumerable"in e&&this.enumerable!==e.enumerable?!1:("get"in e||"set"in e)&&this.dataProperty?!1:"value"in e&&!this.dataProperty?!1:this.dataProperty?this.writable?!0:e.writable?!1:!("value"in e)||i.areSame(this.value,e.value):"get"in e&&this.get!==e.get?!1:"set"in e&&this.set!==e.set?!1:!0},getValue:function(){return this.dataProperty?this.value:this.getter?this.getter.call(this.base):void 0},setValue:function(e){this.canSetValue()&&(this.dataProperty?this.value=e:this.setter&&this.setter.call(this.base,e))},canSetValue:function(){return this.writable||!!this.setter}},t.exports=n},{"../utils/contracts":68}],66:[function(e,t,r){"use strict";function n(e){i.call(this),this.source=e,this.className="RegExp"}var i=e("./object-type");n.prototype=Object.create(i.prototype),n.prototype.constructor=n,n.prototype.init=function(e){this.defineOwnProperty("lastIndex",{value:e.createPrimitive(this.source.lastIndex),writable:!0}),this.defineOwnProperty("source",{value:e.createPrimitive(this.source.source)}),this.defineOwnProperty("global",{value:e.createPrimitive(this.source.global)}),this.defineOwnProperty("ignoreCase",{value:e.createPrimitive(this.source.ignoreCase)}),this.defineOwnProperty("multiline",{value:e.createPrimitive(this.source.multiline)})},t.exports=n},{"./object-type":63}],67:[function(e,t,r){"use strict";function n(e){o.call(this,e)}function i(e,t){if(t<e.value.length){var r=new n(e.value[t]);return r.setPrototype(e.getPrototype()),r}return new o(void 0)}var o=e("./primitive-type"),a=e("./property-descriptor"),u=e("../utils/contracts");n.prototype=Object.create(o.prototype),n.prototype.constructor=n,n.prototype.init=function(e){this.properties.length=new a(this,{configurable:!1,enumerable:!1,writable:!1,value:e.createPrimitive(this.value.length)})},n.prototype.getProperty=function(e){if(u.isInteger(e)){var t=Number(e);if(t<this.value.length)return new a(this,{configurable:!1,enumerable:!0,writable:!1,value:i(this,t)})}return o.prototype.getProperty.apply(this,arguments)},n.prototype.getOwnPropertyNames=function(){var e,t,r=[];for(t=0,e=this.value.length;e>t;t++)r.push(String(t));return r.concat(o.prototype.getOwnPropertyNames.call(this))},n.prototype.hasOwnProperty=function(e){return u.isInteger(e)?e<this.value.length:o.prototype.hasOwnProperty.apply(this,arguments)},t.exports=n},{"../utils/contracts":68,"./primitive-type":64,"./property-descriptor":65}],68:[function(e,t,r){"use strict";var n=/\[object (\w+)\]/,i=/^-?\d+$/;t.exports={assertIsObject:function(e,t,r){if(!this.isObject(e))throw new TypeError(t+" called on non-object")},assertIsNotNullOrUndefined:function(e,t){if(this.isNullOrUndefined(e))throw new TypeError(t+" called on null or undefined")},assertArgIsNotNullOrUndefined:function(e){if(this.isNullOrUndefined(e))throw new TypeError("Cannot convert null or undefined to object")},assertIsFunction:function(e,t){if(!e||"Function"!==e.className)throw new TypeError("%s is not a function")},assertIsNotConstructor:function(e,t){if(e.isNew)throw new TypeError(t+" is not a constructor")},assertIsValidArrayLength:function(e){if(!this.isValidArrayLength(e))throw new RangeError("Invalid array length")},assertIsValidParameterName:function(e){if(/^\d|[;\(\)"']/.test(e))throw new SyntaxError("Unexpected token in "+e)},isValidArrayLength:function(e){return this.isInteger(e)&&e>=0&&4294967296>e},isObject:function(e){return e?e.isPrimitive?e.value&&"object"===e.type:!0:!1},areSame:function(e,t){if(e.type!==t.type)return!1;if(e.isPrimitive&&t.isPrimitive){if(void 0===e.value)return!0;if(null===e.value)return!0;if("number"===e.type){if(isNaN(e.value)&&isNaN(t.value))return!0;if(0===e.value)return 1/e.value===1/t.value}return e.value===t.value}return e===t},getType:function(e){return n.exec(Object.prototype.toString.call(e))[1]},isNullOrUndefined:function(e){return this.isUndefined(e)||this.isNull(e)},isUndefined:function(e){return!e||e.isPrimitive&&void 0===e.value},isNull:function(e){return e&&e.isPrimitive&&null===e.value},isInteger:function(e){return"string"==typeof e?i.test(e):"number"==typeof e?isFinite(e)&&Math.floor(e)===e:!1}}},{}],69:[function(e,t,r){"use strict";function n(e){return 0>e?-1:1}function i(e,t){if(!t)return"undefined";if(t.isPrimitive)return String(t.value);var r=u.tryCallMethod(e,t,"toString");if(r&&r.isPrimitive)return String(r.value);if(r=u.tryCallMethod(e,t,"valueOf"),r&&r.isPrimitive)return String(r.value);throw new TypeError("Cannot convert object to primitive value.")}function o(e,t){if(!t)return 0;if(t.isPrimitive)return t.value;var r=u.tryCallMethod(e,t,"valueOf");if(r&&r.isPrimitive)return r.value;if(r=u.tryCallMethod(e,t,"toString"),r&&r.isPrimitive)return r.value;throw new TypeError("Cannot convert object to primitive")}function a(e,t){for(var r=0,n=t.length,i=[];n>r;r++)i.push(o(e,t[r]));return i}var u=e("./func"),s=Math.floor,c=Math.abs;t.exports={primitiveToObject:function(e,t){var r=e.objectFactory.createPrimitive(t);return r.isPrimitive=!1,r.type="object",r},toObject:function(e,t){return t.isPrimitive&&null!=t.value&&"object"!==t.type?this.primitiveToObject(e,t.value):t},toArray:function(e,t){var r=[];if(e)for(var n=t>=0?t:e.getProperty("length").getValue().value,i=0;n>i;)e.hasProperty(i)&&(r[i]=e.getProperty(i).getValue()),i++;return r},toPrimitive:function(e,t,r){return r=r&&r.toLowerCase(),!r&&t&&(r=t.primitiveHint),"string"===r?i(e,t):o(e,t)},toString:function(e,t){return String(this.toPrimitive(e,t,"string"))},toNumber:function(e,t){return t&&"undefined"!==t.type?Number(this.toPrimitive(e,t,"number")):0/0},toInteger:function(e,t){var r=this.toNumber(e,t);return isNaN(r)?0:0!==r&&isFinite(r)?n(r)*s(c(r)):r},toInt32:function(e,t){var r=this.toNumber(e,t);return 0===r||isNaN(r)||!isFinite(r)?0:n(r)*s(c(r))},toUInt32:function(e,t){var r=this.toInt32(e,t);return r>>>0},toBoolean:function(e){return e?e.isPrimitive?Boolean(e.value):!0:!1},toNativeFunction:function(e,t,r){return e.objectFactory.createBuiltInFunction(function(){var r=this&&this.node&&this.node.value,n=a(e,arguments),i=t.apply(r,n);return e.objectFactory.createPrimitive(i)},t.length,r)}}},{"./func":70}],70:[function(e,t,r){"use strict";t.exports={executeFunction:function(e,t,r,n,i,o,a){var u,s=t.createScope(e.env,i,!1);a&&(u=i),this.loadArguments(e.env,r,n,t);try{if(t["native"])u=t.nativeFunction.apply(e.create(i,o,a),n)||u;else{var c=e.create(t.node.body,o,a).execute();c&&c.exit&&c.result&&(a&&c.result.isPrimitive||(u=c.result))}}catch(l){throw s.exitScope(),l}return s.exitScope(),u||e.env.global.getProperty("undefined").getValue()},getFunctionResult:function(e,t,r,n,i,o){var a=t.createScope(e.env,i,!1);this.loadArguments(e.env,r,n,t);var u;try{u=t["native"]?t.nativeFunction.apply(e.create(i,o,!1),n):e.create(t.node.body,o,!1).execute()}catch(s){throw a.exitScope(),s}return a.exitScope(),u},loadArguments:function(e,t,r,n){var i=e.global.getProperty("undefined").getValue(),o=e.objectFactory.createArguments(r,n);e.current.createVariable("arguments"),e.current.putValue("arguments",o),t.forEach(function(t,n){if(!e.current.hasVariable(t.name)){var a=e.current.createVariable(t.name);r.length>n&&o.mapProperty(n,a)}e.current.putValue(t.name,r[n]||i)});for(var a=r.length,u=t.length;a>u;u++)o.defineOwnProperty(u,{value:r[u],configurable:!0,enumerable:!0,writable:!0});o.defineOwnProperty("length",{value:e.objectFactory.createPrimitive(a),configurable:!0,enumerable:!1,writable:!0})},tryCallMethod:function(e,t,r){var n=t.getProperty(r);if(!n)return!1;n=n.getValue();var i=e.global.getProperty("undefined").getValue();if(n&&"Function"===n.className){var o,a=n.createScope(e,t);try{n["native"]?o=n.nativeFunction.apply(e.createExecutionContext(t,t),[]):(this.loadArguments(e,n.node.params,[]),o=e.createExecutionContext(n.node.body,n.node).execute(),o=o&&o.result)}catch(u){throw a.exitScope(),u}return a.exitScope(),o?o.getValue():i}return!1}}},{}]},{},[1])(1)});